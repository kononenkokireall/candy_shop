from itertools import product
from typing import List, Any

from aiogram.types import InlineKeyboardButton, InlineKeyboardMarkup
from aiogram.utils.keyboard import InlineKeyboardBuilder

from keyboards.inline_main import MenuCallBack


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Ä–∞–∑–¥–µ–ª–∞ –∫–∞—Ç–∞–ª–æ–≥–∞.
def get_user_catalog_btn(
        *,
        level: int,
        categories: List[Any],
        sizes: tuple[int, ...] = (2,))\
        -> InlineKeyboardMarkup:

    """
    –°–æ–∑–¥–∞–µ—Ç inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ —Ç–æ–≤–∞—Ä–æ–≤, –≤–∫–ª—é—á–∞—é—â—É—é –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥",
     "–ö–æ—Ä–∑–∏–Ω–∞"
    –∏ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞.

    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
      - level: —Ç–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –º–µ–Ω—é,
       –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è callback-–¥–∞–Ω–Ω—ã—Ö.
      - categories: —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–π.
       –ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã:
                    - name: —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏,
                     –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –∫–Ω–æ–ø–∫–µ;
                    - id: –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏,
                     –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ callback-–¥–∞–Ω–Ω—ã—Ö.
      - sizes: –∫–æ—Ä—Ç–µ–∂,
       –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
        (–Ω–∞–ø—Ä–∏–º–µ—Ä, (2,) –æ–∑–Ω–∞—á–∞–µ—Ç –ø–æ 2 –∫–Ω–æ–ø–∫–∏ –≤ —Ä—è–¥—É).

    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
      - InlineKeyboardMarkup, –≥–æ—Ç–æ–≤—É—é –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
    """
    # –°–æ–∑–¥–∞–µ–º –±–∏–ª–¥–µ—Ä –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.
    keyboard = InlineKeyboardBuilder()

    # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É "‚óÄÔ∏è–í–µ—Ä–Ω—É—Ç—Å—è" –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –º–µ–Ω—é.
    # –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ callback-–¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã
    # —Å —É–º–µ–Ω—å—à–µ–Ω–Ω—ã–º —É—Ä–æ–≤–Ω–µ–º –∏ –∏–º–µ–Ω–µ–º –º–µ–Ω—é 'main'.
    keyboard.add(
        InlineKeyboardButton(
            text="‚óÄÔ∏è–í–µ—Ä–Ω—É—Ç—Å—è",
            callback_data=MenuCallBack(level=level - 1,
                                       menu_name="main").pack(),
        )
    )

    # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É "–ö–æ—Ä–∑–∏–Ω–∞ üõí" –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É.
    # –ó–¥–µ—Å—å —É—Ä–æ–≤–µ–Ω—å –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω —Ä–∞–≤–Ω—ã–º 3, –∞ –∏–º—è –º–µ–Ω—é ‚Äî 'cart'.
    keyboard.add(
        InlineKeyboardButton(
            text="–ö–æ—Ä–∑–∏–Ω–∞ üõí",
            callback_data=MenuCallBack(level=3, menu_name="cart", product_id=42).pack(),
        )
    )

    # –î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–æ–±–∞–≤–ª—è–µ–º –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–Ω–æ–ø–∫—É.
    # –¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∞ callback-–¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç:
    # - —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –º–µ–Ω—é (level + 1),
    # ‚Äî –∏–º—è –º–µ–Ω—é, —Ä–∞–≤–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏—é –∫–∞—Ç–µ–≥–æ—Ä–∏–∏,
    # ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (category).
    for ctg in categories:
        keyboard.add(
            InlineKeyboardButton(
                text=ctg.name,
                callback_data=MenuCallBack(
                    level=level + 1, menu_name=ctg.name, category=ctg.id
                ).pack(),
            )
        )

    # –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –ø–æ —Ä—è–¥–∞–º —Å–æ–≥–ª–∞—Å–Ω–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º —Ä–∞–∑–º–µ—Ä–∞–º.
    # –ú–µ—Ç–æ–¥ adjust() –∑–∞–¥–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –∫–Ω–æ–ø–æ–∫ –±—É–¥–µ—Ç –≤ –∫–∞–∂–¥–æ–º —Ä—è–¥—É.
    return keyboard.adjust(*sizes).as_markup()  # type: ignore
